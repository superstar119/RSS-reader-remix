{
  "version": 3,
  "sources": ["../../../node_modules/s-ago/index.js", "../../../app/routes/feeds.list.tsx", "../../../app/components/layout/side-bar.tsx"],
  "sourcesContent": ["\"use strict\";\n/*\n\nUsage:\n\nvar ago = require('s-ago');\n\nvar now = new Date();\nvar yesterday = new Date(now.getTime() - (24 * 60 * 60 * 1000));\nvar hoursAgo = new Date(now.getTime() - (6 * 60 * 60 * 1000));\n\nago(now); // 'just now'\nago(yesterday); // 'yesterday'\nago(hoursAgo); // '6 hours ago'\n\n*/\nfunction format(diff, divisor, unit, past, future, isInTheFuture) {\n    var val = Math.round(Math.abs(diff) / divisor);\n    if (isInTheFuture)\n        return val <= 1 ? future : 'in ' + val + ' ' + unit + 's';\n    return val <= 1 ? past : val + ' ' + unit + 's ago';\n}\nvar units = [\n    { max: 2760000, value: 60000, name: 'minute', past: 'a minute ago', future: 'in a minute' },\n    { max: 72000000, value: 3600000, name: 'hour', past: 'an hour ago', future: 'in an hour' },\n    { max: 518400000, value: 86400000, name: 'day', past: 'yesterday', future: 'tomorrow' },\n    { max: 2419200000, value: 604800000, name: 'week', past: 'last week', future: 'in a week' },\n    { max: 28512000000, value: 2592000000, name: 'month', past: 'last month', future: 'in a month' } // max: 11 months\n];\nmodule.exports = function ago(date, max) {\n    var diff = Date.now() - date.getTime();\n    // less than a minute\n    if (Math.abs(diff) < 60000)\n        return 'just now';\n    for (var i = 0; i < units.length; i++) {\n        if (Math.abs(diff) < units[i].max || (max && units[i].name === max)) {\n            return format(diff, units[i].value, units[i].name, units[i].past, units[i].future, diff < 0);\n        }\n    }\n    // `year` is the final unit.\n    // same as:\n    //  {\n    //    max: Infinity,\n    //    value: 31536000000,\n    //    name: 'year',\n    //    past: 'last year'\n    //  }\n    return format(diff, 31536000000, 'year', 'last year', 'in a year', diff < 0);\n};\n", "// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app\\\\\\\\routes\\\\\\\\feeds.list.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app\\\\routes\\\\feeds.list.tsx\");\n  import.meta.hot.lastModified = \"1706039928344.5427\";\n}\n// REMIX HMR END\n\nimport { redirect } from \"@remix-run/node\";\nimport { useLoaderData, useFetcher, Link } from \"@remix-run/react\";\nimport { Text } from \"~/components/ui/text\";\nimport { getUser } from \"~/models/session.server\";\nimport preview from \"../assets/preview-placeholder.png\";\nimport { useEffect, useState, useRef, useContext } from \"react\";\nimport { getUserFeedSubscription } from \"~/models/feed-subscription.server\";\nimport { getPosts, getUnreadPostsNumber } from \"~/models/post.server\";\nimport { ThreeDots } from \"react-loading-icons\";\nimport ago from \"s-ago\";\nimport layoutContext from \"~/lib/context\";\nimport { cn } from \"~/lib/utils\";\nimport { Sidebar } from \"~/components/layout/side-bar\";\nimport { getFeedById } from \"~/models/feed.server\";\nexport const loader = async ({\n  request\n}) => {\n  const user = await getUser(request);\n  if (!user) return redirect(\"/\");\n  const url = new URL(request.url);\n  const page = url.searchParams.get(\"page\") || 0;\n  const skip = Number(page) * 30;\n  const take = 30;\n  const subscriptions = await getUserFeedSubscription(user.id);\n  const posts = await getPosts(subscriptions.map(item => item.feedId), skip, take);\n  let totalUnread = await getUnreadPostsNumber(user.id, subscriptions);\n  let sidebarData = [{\n    item: \"All\",\n    unread: totalUnread\n  }];\n  for (const item of subscriptions) {\n    const feed = await getFeedById(item.feedId);\n    const unread = await getUnreadPostsNumber(user.id, [item]);\n    if (feed) {\n      sidebarData.push({\n        item: feed.title,\n        unread: unread\n      });\n    }\n  }\n  return {\n    sidebarData: sidebarData,\n    data: posts,\n    page: page\n  };\n};\nconst InfiniteScroller = props => {\n  _s();\n  const {\n    children,\n    loading,\n    loadNext\n  } = props;\n  const scrollListener = useRef(loadNext);\n  useEffect(() => {\n    scrollListener.current = loadNext;\n  }, [loadNext]);\n  const onScroll = () => {\n    const documentHeight = document.documentElement.scrollHeight;\n    const scrollDifference = Math.floor(window.innerHeight + window.scrollY);\n    const scrollEnded = documentHeight == scrollDifference;\n    if (scrollEnded && !loading) {\n      scrollListener.current();\n    }\n  };\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      window.addEventListener(\"scroll\", onScroll);\n    }\n    return () => {\n      window.removeEventListener(\"scroll\", onScroll);\n    };\n  }, []);\n  return <>{children}</>;\n};\n_s(InfiniteScroller, \"BAsJnOth0ocrxnb72irYp7lpUkI=\");\n_c = InfiniteScroller;\nconst FeedList = () => {\n  _s2();\n  const initial = useLoaderData();\n  const fetcher = useFetcher();\n  const {\n    layout\n  } = useContext(layoutContext);\n  const [posts, setPosts] = useState(initial.data);\n  useEffect(() => {\n    if (!fetcher.data || fetcher.state === \"loading\") return;\n    if (fetcher.data) {\n      const newItems = fetcher.data.data;\n      setPosts(prevPosts => [...prevPosts, ...newItems]);\n    }\n  }, [fetcher.data]);\n  return <div className=\"relative w-full h-full\">\r\n      <div className=\"fixed top-[230px] left-[40px]\">\r\n        <Sidebar items={initial.sidebarData} />\r\n      </div>\r\n      <InfiniteScroller loadNext={() => {\n      const page = fetcher.data ? Number(fetcher.data.page) + 1 : Number(initial.page) + 1;\n      const query = `?page=${page}`;\n      fetcher.load(query);\n    }} loading={fetcher.data === \"loading\"}>\r\n        <div className={cn(\"w-[590px] mx-auto mt-[180px] animate-fade-in\", layout === \"imageList\" ? \"grid grid-cols-2\" : \"flex flex-col gap-[10px]\")}>\r\n          {posts.map((item, index) => {\n          return <Link to={`/feeds/${item.id}`} key={index}>\r\n                <div className={cn(\"flex px-[15px] gap-[15px] items-center\", layout === \"textList\" ? \"py-[12px]\" : layout === \"imageList\" ? \"py-[15px] flex-col\" : \"py-[15px]\")}>\r\n                  <div className={cn(\" bg-cover bg-center rounded-[3px]\", layout === \"textList\" ? \"hidden\" : layout === \"imageList\" ? \"w-full aspect-square\" : \"w-[60px] min-w-[60px] min-h-[60px] h-[60px]\")} style={{\n                backgroundImage: `url(${item.imgSrc ? item.imgSrc : preview})`\n              }} />\r\n                  <div className=\"flex flex-col gap-[5px] w-full\">\r\n                    <Text className=\"truncate w-full overflow-hidden\">\r\n                      {item.title}\r\n                    </Text>\r\n                    <Text className=\"text-[14px] text-[#c0c0c0]\">\r\n                      {item.author + \" / \" + ago(new Date(item.pubDate))}\r\n                    </Text>\r\n                  </div>\r\n                </div>\r\n              </Link>;\n        })}\r\n          <div className=\"w-full flex justify-center items-center py-[20px] mb-[180px]\">\r\n            {fetcher.state === \"loading\" && <ThreeDots fill=\"#c0c0c0\" className=\"w-[40px] h-[20px]\" />}\r\n          </div>\r\n        </div>\r\n      </InfiniteScroller>\r\n    </div>;\n};\n_s2(FeedList, \"qDvZC8QsjprKOS5ONKP9l9rAfCc=\", false, function () {\n  return [useLoaderData, useFetcher];\n});\n_c2 = FeedList;\nexport default FeedList;\nvar _c, _c2;\n$RefreshReg$(_c, \"InfiniteScroller\");\n$RefreshReg$(_c2, \"FeedList\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;", "// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app\\\\\\\\components\\\\\\\\layout\\\\\\\\side-bar.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app\\\\components\\\\layout\\\\side-bar.tsx\");\n  import.meta.hot.lastModified = \"1706040014983.0093\";\n}\n// REMIX HMR END\n\nimport { Text } from \"../ui/text\";\nexport const Sidebar = ({\n  items\n}) => {\n  return <div className=\"flex flex-col gap-[22px] w-[220px] max-w-[220px] opacity-0 hover:opacity-100 transition-opacity transition-duration-500\">\r\n      {items.map((item, index) => <div className=\"flex gap-[5px] items-baseline w-[200px] \" key={index}>\r\n          <Text className=\"text-[#000] truncate \">{item.item}</Text>\r\n          <sup>\r\n            <Text className=\"text-[#c0c0c0] text-[14px]\">{item.unread}</Text>\r\n          </sup>\r\n        </div>)}\r\n    </div>;\n};\n_c = Sidebar;\nvar _c;\n$RefreshReg$(_c, \"Sidebar\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": ["ago", "import_react", "import_jsx_dev_runtime", "_c", "ago", "_c2"]
}
